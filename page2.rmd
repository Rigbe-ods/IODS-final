---
title: IODS course final project
author: "Rigbe G. Weldatsadik"
date: 10/12/2016
output:
  html_document:
    theme: cosmo
    toc: true
    toc_depth: 2
    fig_caption: true
    fig_width: 6
    fig_height: 4
    code_folding: hide
---

## Method description
# Next I will use LDA to classify students and predict student's portugese and maths grades based on the numeric variables only which were scaled in the data wrangling part and i have also removed collinear varibales before fitting LDA
# Again I am fitting models separately for the two subjects 

```{r}
library(dplyr)
library(MASS)

mathPor2_scaled <- read.table("data/mathPor2_scaled.csv",header=T, sep="\t")
str(mathPor2_scaled)
#math
math3 <- mathPor2_scaled %>% dplyr::select(-one_of('G3_binary.por','G1.math','G2.math','G1.por','G2.por','studytime.por','Fedu','Walc'))
str(math3)
# sample 80 percent of the data, i.e. you have the row indices here
ind <- sample(nrow(math3),  size = nrow(math3) * 0.8)

# based on those indices we choose our training set
train <- math3[ind,]
str(train)
# the rest is the test data 
test <- math3[-ind,]

# we know the correct classes from our test set
correct_classes <- test$G3_binary.math

# remove the grade classes, so that we replace them with the predicted values from the next steps
test <- dplyr::select(test, -G3_binary.math)

lda.fit <- lda(G3_binary.math ~ . , data = train)

classes <- as.numeric(train$G3_binary.math)
plot(lda.fit, dimen = 2,col = classes,pch=classes)

lda.pred <- predict(lda.fit, newdata = test)

# cross tabulate the results
table(correct = correct_classes, predicted = lda.pred$class)

library(ROCR)

par(mfrow=c(1, 2))

prediction(as.numeric(lda.pred$class), as.numeric(correct_classes)) %>%
  performance(measure = "tpr", x.measure = "fpr") %>%
  plot()

```